<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css">
  <link rel="stylesheet" href="css/style.css">
  <script src="https://unpkg.com/@googlemaps/markerclusterer/dist/index.min.js"></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/markerclustererplus/2.1.4/markerclusterer.min.js"></script> -->
</head>

<body>
  <header>
    <nav class="topNav">
      <div class="leftNav"><img src="images/logoTitlr.JPG" alt="StockManTextLogo"></div>
      <div class="rightNav">
        <li><a href="index.html">首頁</a></li>
        <li><a href="why.html">理財與股票</a></li>
        <li><a href="search.html">查詢股票</a></li>
        <li class="active"><a href="recommend.html">推薦券商與地圖</a></li>
      </div>
      <div class="navMenu"><i class='bx bx-menu'></i></div>
      <div class="mobileMenu d-none">
        <div class="menuClose"><i class='bx bx-x'></i></div>
        <li><a href="index.html">首頁</a></li>
        <li><a href="why.html">理財與股票</a></li>
        <li><a href="search.html">查詢股票</a></li>
        <li><a href="recommend.html">推薦券商與地圖</a></li>
      </div>
    </nav>
  </header>

  <!-- Recommend Bank-->
  <section class="recommend">
    <div class="container">
      <div class="recmdBank">
        <div class="flip-card">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <img src="images/skis.jpg" alt="skis">
            </div>
            <div class="flip-card-back">
              <h1>新光證券</h1>
              <p>手續費2.8折，整/零股手續費最低1元</p>
              <p>開戶禮：3000 元手續費抵用金</p>
              <p>開戶次月底前下單送7-11購物金</p>
            </div>
          </div>
        </div>
        <div class="flip-card">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <img src="images/cathay.jfif" alt="cathay">
            </div>
            <div class="flip-card-back">
              <h1>國泰證券</h1>
              <p>手續費2.8折，整/零股手續費最低1元</p>
              <p>定期定額，每筆手續費最低 1 元</p>
            </div>
          </div>
        </div>
        <div class="flip-card">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <img src="images/fugle.png" alt="fugle">
            </div>
            <div class="flip-card-back">
              <h1>玉山富果證券</h1>
              <p>100 萬內 6.5 折<br>100-300 萬 5 折<br>300 以上 3.8 折</p>
              <p>友善的網站與APP操作介面</p>
            </div>
          </div>
        </div>
        <div class="flip-card">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <img src="images/sinopac.png" alt="sinopac">
            </div>
            <div class="flip-card-back">
              <h1>永豐金證券</h1>
              <p>手續費6.5折，整/零股手續費最低1元</p>
              <p>證券開戶享交割戶1.5%高利活儲</p>
            </div>
          </div>
        </div>
        <div class="flip-card">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <img src="images/yuanto.jpg" alt="yuanto">
            </div>
            <div class="flip-card-back">
              <h1>元大證券</h1>
              <p>手續費6折，零股手續費最低1元</p>
              <p>定期定額扣款3次，送 200 + 500 抵免額度</p>
            </div>
          </div>
        </div>
        <div class="flip-card">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <img src="images/taishin.jpg" alt="taishin">
            </div>
            <div class="flip-card-back">
              <h1>台新證券</h1>
              <p>手續費3折，零股手續費最低1元</p>
            </div>
          </div>
        </div>
      </div>
      <div class="Bankmap bg-gray">
        <div class="bankSelect">
          <a id="skis">新光證券</a>
          <a id="cathay">國泰證券</a>
          <a id="fugle">玉山富果</a>
          <a id="sinopac">永豐金證券</a>
          <a id="yuanto">元大證券</a>
          <a id="taishin">台新證券</a>
        </div>
        <div class="map" id="map" style="overflow: hidden;">
          
        </div>
      </div>
    </div>
  </section>

  <!-- footer -->
  <footer>
    <div class="m-auto container">
      <div class="f-content d-grid">
        <img src="images/footerLogo.PNG" alt="">
        <div class="f-link">
          <li class="nav-item text-center">
            <a class="nav-link active" aria-current="page" href="index.html">首頁</a>
          </li>
          <li class="nav-item text-center">
            <a class="nav-link" href="search.html">查詢股票</a>
          </li>
          <li class="nav-item text-center">
            <a class="nav-link" href="why.html">常見問題</a>
          </li>
        </div>
      </div>
    </div>
  </footer>
  <script src="js/recommend.js"></script>
  <script>
    // 動態控制推薦券商的區塊高度
    document.getElementsByClassName("recmdBank")[0].style.height = `${document.querySelector('img[alt="skis"]').offsetHeight * 2.2}px`;

    for (let i = 0; i < document.getElementsByClassName("flip-card").length; i++) {
      document.getElementsByClassName("flip-card")[i].style.height = `${document.querySelector('img[alt="skis"]').offsetHeight}px`;
    }

    window.addEventListener('resize', function () {
      document.getElementsByClassName("recmdBank")[0].style.height = `${document.querySelector('img[alt="skis"]').offsetHeight * 2.2}px`;
      for (let i = 0; i < document.getElementsByClassName("flip-card").length; i++) {
        document.getElementsByClassName("flip-card")[i].style.height = `${document.querySelector('img[alt="skis"]').offsetHeight}px`;
      }
    })
    // 推薦券商end

    // 初始地圖
    // 圖釘陣列
    let markers = []
    // 地圖資料
    let skis = [
      { county: "台北市", lat: "25.043823962519046", lng: "121.51309815952241", sitename: "新光台北總公司", address: "台北市中正區重慶南路一段66-1號" },
      { county: "桃園市", lat: "24.992751692880745", lng: "121.31379783065243", sitename: "新光桃園分公司", address: "桃園市桃園區民生路105號" },
      { county: "新竹縣", lat: "24.82110014350798", lng: "121.02561997606115", sitename: "新光新竹分公司", address: "新竹縣竹北市光明六路東一段238號" },
      { county: "台中市", lat: "24.149433009319505", lng: "120.67009770740304", sitename: "新光台中分公司", address: "台中市西區民權路318號" },
      { county: "台南市", lat: "22.984760549265584", lng: "120.22496988620934", sitename: "新光台南分公司", address: "台南市東區東門路二段262號" },
      { county: "高雄市", lat: "22.62946022863349", lng: "120.29638057301494", sitename: "新光高雄分公司", address: "高雄市前金區中正四路151號" },
    ]

    let cathay = [
      { county: "台北市", lat: "25.022382043117787", lng: "121.54922239786418", sitename: "國泰台北總公司", address: "台北市大安區敦化南路二段333號19樓" },
      { county: "台北市", lat: "25.022382043117787", lng: "121.54922239786418", sitename: "國泰敦南分公司", address: "台北市大安區敦化南路二段333號5樓" },
      { county: "台北市", lat: "25.044597307295046", lng: "121.51521291320763", sitename: "國泰館前分公司", address: "台北市中正區館前路65號5樓" },
      { county: "台北市", lat: "25.041933651223943", lng: "121.55251935368534", sitename: "國泰忠孝分公司", address: "台北市大安區忠孝東路四段219號5樓" },
      { county: "台北市", lat: "25.053317630461287", lng: "121.53263435368542", sitename: "國泰松江分公司", address: "台北市中山區松江路136號3樓" },
      { county: "新北市", lat: "25.019041870821365", lng: "121.47895908650746", sitename: "國泰板橋分公司", address: "新北市板橋區三民路一段216號4樓" },
      { county: "新北市", lat: "25.03480972688196", lng: "121.44589007087923", sitename: "國泰新莊分公司", address: "新北市新莊區中正路387號12樓" },
      { county: "桃園市", lat: "25.017740484125145", lng: "121.29756384204317", sitename: "國泰桃園分公司", address: "桃園市桃園區中正路1125號2樓" },
      { county: "台中市", lat: "24.157664990727465", lng: "120.65783000949483", sitename: "國泰台中分公司", address: "台中市西區臺灣大道二段573號11樓" },
      { county: "台南市", lat: "22.993600284109093", lng: "120.20340609968959", sitename: "國泰台南分公司", address: "台南市中西區民生路一段62號3樓" },
      { county: "高雄市", lat: "22.63102387310464", lng: "120.30840157084975", sitename: "國泰高雄分公司", address: "高雄市新興區中正三路55號9樓之2" },
    ]

    let fugle = [
      { county: "台北市", lat: "25.057587998245964", lng: "121.54777455767164", sitename: "玉山證券經紀本部", address: "台北市松山區民生東路三段156號2樓" },
      { county: "台北市", lat: "24.99330999477354", lng: "121.54152831320704", sitename: "玉山景美分公司", address: "台北市文山區景中街1號2樓" },
      { county: "台北市", lat: "25.09532502159513", lng: "121.52428545553681", sitename: "玉山士林分公司", address: "台北市士林區中正路266號3樓" },
      { county: "台北市", lat: "25.051971030569256", lng: "121.56007108252109", sitename: "玉山南東分公司", address: "台北市松山區南京東路五段89號B1" },
      { county: "台北市", lat: "25.044626966423593", lng: "121.50958811320776", sitename: "玉山城中分公司", address: "台北市中正區武昌街一段77號3樓" },
      { county: "新北市", lat: "25.00739362947545", lng: "121.50653488252075", sitename: "玉山雙和分公司", address: "新北市永和區保生路1號16樓之1" },
      { county: "新北市", lat: "25.051166093166", lng: "121.460052311357", sitename: "玉山新莊分公司", address: "新北市新莊區思源路332巷1號3樓" },
      { county: "新北市", lat: "25.009939326686357", lng: "121.46115131135653", sitename: "玉山板橋分公司", address: "新北市板橋區中山路一段67號8樓" },
      { county: "桃園市", lat: "25.00508077189305", lng: "121.30508968437138", sitename: "玉山桃園分公司", address: "桃園市桃園區信光路125號3、4樓" },
      { county: "新竹市", lat: "24.785715637799623", lng: "121.01185749601031", sitename: "玉山新竹分公司", address: "新竹市東區光復路一段569號3、4樓" },
      { county: "台中市", lat: "24.15906729108279", lng: "120.64030218436046", sitename: "玉山台中分公司", address: "台中市西屯區市政路386號17樓之6" },
      { county: "台中市", lat: "24.10900986483017", lng: "120.67978604203154", sitename: "玉山大里分公司", address: "台中市大里區國光路二段407號3樓" },
      { county: "嘉義市", lat: "23.47941715212556", lng: "120.44503991318793", sitename: "玉山嘉義分公司", address: "嘉義市西區中山路497號2樓" },
      { county: "台南市", lat: "22.980661654946143", lng: "120.22402956715227", sitename: "玉山台南分公司", address: "台南市東區崇學路108號3樓" },
      { county: "高雄市", lat: "22.63747134676639", lng: "120.33999722852126", sitename: "玉山高雄分公司", address: "高雄市三民區九如一路156號" },
      { county: "高雄市", lat: "22.668033187152908", lng: "120.30361858249186", sitename: "玉山左營分公司", address: "高雄市左營區博愛二路576號B1" },
    ]

    let sinopac = [
      { county: "台北市", lat: "25.047077221515572", lng: "121.51293815553592", sitename: "永豐總公司", address: "台北市中正區重慶南路一段2號7、18、20樓" },
      { county: "台北市", lat: "25.044577546402657", lng: "121.51161626902869", sitename: "永豐博愛分公司", address: "台北市中正區博愛路57號1樓" },
      { county: "台北市", lat: "25.105003628866857", lng: "121.52738128437271", sitename: "永豐天母分公司", address: "台北市士林區忠誠路一段62號2樓" },
      { county: "新北市", lat: "25.009136265149554", lng: "121.46088674019234", sitename: "永豐板橋分公司", address: "新北市板橋區中山路一段48號3、4、5樓" },
      { county: "宜蘭縣", lat: "24.678191803749517", lng: "121.77187414203891", sitename: "永豐羅東分公司", address: "宜蘭縣羅東鎮中正路203號2、3樓" },
      { county: "桃園市", lat: "24.99122067059368", lng: "121.30810072855031", sitename: "永豐桃園分公司", address: "桃園市桃園區南華街77號3樓之1、2" },
      { county: "新竹市", lat: "24.808279897899563", lng: "120.96711392484642", sitename: "永豐新竹分公司", address: "新竹市北區中正路129號" },
      { county: "新竹縣", lat: "24.828063662910605", lng: "121.01008295553325", sitename: "永豐竹北分公司", address: "新竹縣竹北市縣政九路145號2樓" },
      { county: "台中市", lat: "24.148064903839526", lng: "120.67413124018124", sitename: "永豐台中分公司", address: "台中市西區台灣大道一段728號7樓" },
      { county: "彰化縣", lat: "24.0783563531898", lng: "120.54095915552358", sitename: "永豐彰化分公司", address: "彰化縣彰化市民族路532號5、6樓" },
      { county: "南投縣", lat: "23.907591075720298", lng: "120.68774276901397", sitename: "永豐南投分公司", address: "南投縣南投市文昌街45號1、2樓" },
      { county: "嘉義市", lat: "23.480020337410316", lng: "120.44601126900893", sitename: "永豐嘉義分公司", address: "嘉義市西區中山路386號3樓" },
      { county: "雲林縣", lat: "23.707707087352755", lng: "120.43596822853404", sitename: "永豐虎尾分公司", address: "雲林縣虎尾鎮新生路136號3樓" },
      { county: "台南市", lat: "22.98632009316427", lng: "120.19744421318224", sitename: "永豐台南分公司", address: "台南市南區西門路一段655號4樓" },
      { county: "高雄市", lat: "22.62993284727271", lng: "120.32813472667048", sitename: "永豐高雄分公司", address: "高雄市苓雅區中正一路284號2、3樓" },
      { county: "屏東縣", lat: "22.67550387312953", lng: "120.48953330947703", sitename: "永豐屏東分公司", address: "屏東縣屏東市中正路125號4樓" },
    ]

    let yuanto = [
      { county: "台北市", lat: "25.052264754367638", lng: "121.54311515368539", sitename: "元大經紀部", address: "臺北市中山區南京東路3段219號11樓" },
      { county: "台北市", lat: "25.041438453953326", lng: "121.57220397087939", sitename: "元大信義分公司", address: "台北市信義區忠孝東路五段293號2樓" },
      { county: "台北市", lat: "25.042173730481338", lng: "121.50910119971509", sitename: "元大西門分公司", address: "台北市中正區寶慶路69號3樓" },
      { county: "基隆市", lat: "25.129346251420376", lng: "121.7475833708804", sitename: "元大基隆分公司", address: "基隆市信義區信一路132號3樓" },
      { county: "新北市", lat: "25.008283650495898", lng: "121.46015474019222", sitename: "元大新北分公司", address: "新北市板橋區中山路一段10號6樓" },
      { county: "桃園市", lat: "25.02374244085443", lng: "121.29593525553591", sitename: "元大桃園分公司", address: "桃園市桃園區莊敬路一段375號2樓" },
      { county: "新竹市", lat: "24.813249666439567", lng: "120.97486332484641", sitename: "元大新竹分公司", address: "新竹市民生路276號2樓" },
      { county: "新竹縣", lat: "24.73035498533921", lng: "121.08925445738268", sitename: "元大新東分公司", address: "新竹縣竹東鎮大鄉里大林路121號" },
      { county: "宜蘭縣", lat: "24.679604058597754", lng: "121.7720294997103", sitename: "元大羅東分公司", address: "宜蘭縣羅東鎮中正北路32號" },
      { county: "苗栗縣", lat: "24.560129921863126", lng: "120.82142441320131", sitename: "元大苗栗分公司", address: "苗栗縣苗栗市中正路462號4樓之1" },
      { county: "台中市", lat: "24.1385539449577", lng: "120.68075649785287", sitename: "元大台中分公司", address: "台中市中區自由路2段8號3樓之1" },
      { county: "台中市", lat: "24.106207666350496", lng: "120.68052115367334", sitename: "元大大里分公司", address: "台中市大里區國光路二段259號2樓" },
      { county: "台中市", lat: "24.13033787266607", lng: "120.72025281319608", sitename: "元大太平分公司", address: "台中市太平區中興東路62號3樓" },
      { county: "彰化縣", lat: "24.07449364831214", lng: "120.54219491319526", sitename: "元大彰化分公司", address: "彰化縣彰化市華山路37號3樓" },
      { county: "花蓮縣", lat: "23.989907317336854", lng: "121.60134622668679", sitename: "元大花蓮分公司", address: "花蓮縣花蓮市國聯一路167號2樓" },
      { county: "南投縣", lat: "23.910167054971893", lng: "120.68543429784995", sitename: "元大南投分公司", address: "南投市中山街202號4樓之2、3、5" },
      { county: "雲林縣", lat: "23.70865537867347", lng: "120.54067116716085", sitename: "元大斗六分公司", address: "雲林縣斗六市中和里中山路82號6樓" },
      { county: "嘉義市", lat: "23.48378138882536", lng: "120.44739844017315", sitename: "元大嘉義分公司", address: "嘉義市西區林森西路173號3樓" },
      { county: "台南市", lat: "22.98497400307129", lng: "120.21801156900297", sitename: "元大台南分公司", address: "台南市東區長榮路一段203號5樓" },
      { county: "高雄市", lat: "22.654879021184957", lng: "120.31577984016332", sitename: "元大高雄分公司", address: "高雄市三民區民族一路462號二樓" },
      { county: "高雄市", lat: "22.684031857116306", lng: "120.28926018434281", sitename: "元大左營分公司", address: "高雄市左營區左營大路158號3、4樓" },
      { county: "高雄市", lat: "22.632802966370196", lng: "120.3130567113272", sitename: "元大六和分公司", address: "高雄市新興區民族二路97號4樓" },
      { county: "屏東縣", lat: "22.68565566238221", lng: "120.49642461317868", sitename: "元大屏東分公司", address: "屏東市廣東路690號2-3樓" },
      { county: "金門縣", lat: "24.438772203481083", lng: "118.31956465552823", sitename: "元大金門分公司", address: "金門縣金城鎮民權路188號" },
    ];

    let taishin = [
      { county: "台北市", lat: "25.05312750576956", lng: "121.52229016717791", sitename: "台新台北營業部", address: "台北市中山區中山北路二段 44 號 2 樓" },
      { county: "台北市", lat: "25.05294495334262", lng: "121.54385945553626", sitename: "台新復興共銷部", address: "台北市中山區復興北路 150 號 3 樓" },
      { county: "台北市", lat: "25.041388952217144", lng: "121.55578306902852", sitename: "台新忠孝共銷部", address: "台北市大安區忠孝東路四段 290 號 2 樓" },
      { county: "新北市", lat: "25.02331381976997", lng: "121.42585114019242", sitename: "台新新北分公司", address: "新北市新莊區民安路 179 號地下 1 樓" },
      { county: "桃園市", lat: "24.988995545728752", lng: "121.30867628437117", sitename: "台新桃園共銷處", address: "桃園市桃園區復興路 205 號 3 樓" },
      { county: "新竹市", lat: "24.80007922965141", lng: "120.98964055368198", sitename: "台新新竹共銷處", address: "新竹市東區光復路二段 289 號 1 樓" },
      { county: "台中市", lat: "24.141564360727926", lng: "120.65276899600215", sitename: "台新台中分公司", address: "台中市南屯區東興路二段 187 號 3 樓" },
      { county: "彰化縣", lat: "24.083526696510297", lng: "120.54623177086701", sitename: "台新彰化共銷處", address: "彰化縣彰化市中正路一段 273 號 2 樓" },
      { county: "嘉義市", lat: "23.473725680949936", lng: "120.44392459784463", sitename: "台新嘉義共銷處", address: "嘉義市西區垂楊路 620 號 3 樓" },
      { county: "台南市", lat: "22.99887318589359", lng: "120.20045454016733", sitename: "台新台南分公司", address: "台南市中西區西門路二段389號3樓" },
      { county: "高雄市", lat: "22.613593401246252", lng: "120.30513155550614", sitename: "台新高雄分公司", address: "高雄市前鎮區中山二路 260 號 3 樓之一" },
      { county: "屏東市", lat: "22.673242077375566", lng: "120.49942296899931", sitename: "台新屏東分公司", address: "屏東縣屏東市廣東路 107 號 2-4 樓" },
    ]


    window.onload = function () {
      let records = [];

      skis.forEach(function (rd) {
        records.push(new Location(rd.county, rd.sitename, rd.address, rd.lat, rd.lng))
      })
      cathay.forEach(function (rd) {
        records.push(new Location(rd.county, rd.sitename, rd.address, rd.lat, rd.lng))
      })
      fugle.forEach(function (rd) {
        records.push(new Location(rd.county, rd.sitename, rd.address, rd.lat, rd.lng))
      })
      sinopac.forEach(function (rd) {
        records.push(new Location(rd.county, rd.sitename, rd.address, rd.lat, rd.lng))
      })
      yuanto.forEach(function (rd) {
        records.push(new Location(rd.county, rd.sitename, rd.address, rd.lat, rd.lng))
      })
      taishin.forEach(function (rd) {
        records.push(new Location(rd.county, rd.sitename, rd.address, rd.lat, rd.lng))
      })

      // pinMarkerCluster(records)
      records.forEach(function (rd) {
        markers.push(
          new google.maps.Marker({
            position: rd.center,
            map: map,
            title: rd.sitename
          })
        )
      })
      
      const markerCluster = new markerClusterer.MarkerClusterer({ map, markers });

      document.getElementById("skis").addEventListener("click", function () {
        let skismap = [];
        skis.forEach(function (rd) {
          skismap.push(new Location(rd.county, rd.sitename, rd.address, rd.lat, rd.lng))
        });

        // markerCluster.clearMarkers(true);
        markerCluster.removeMarkers(markers);
        markers = [];

        skismap.forEach(function (rd) {
          markers.push(
            new google.maps.Marker({
              position: rd.center,
              map: map,
              title: rd.sitename
            })
          )
        })
        
        markerCluster.addMarkers(markers)
      })
      document.getElementById("cathay").addEventListener("click", function () {
        let cathaymap = [];
        cathay.forEach(function (rd) {
          cathaymap.push(new Location(rd.county, rd.sitename, rd.address, rd.lat, rd.lng))
        });

        // 清空圖釘
        markerCluster.removeMarkers(markers);
        markers = [];

        cathaymap.forEach(function (rd) {
          markers.push(
            new google.maps.Marker({
              position: rd.center,
              map: map,
              title: rd.sitename
            })
          )
        })
        
        markerCluster.addMarkers(markers)
      })
      document.getElementById("fugle").addEventListener("click", function () {
        let fuglemap = [];
        fugle.forEach(function (rd) {
          fuglemap.push(new Location(rd.county, rd.sitename, rd.address, rd.lat, rd.lng))
        });

        // 清空圖釘
        markerCluster.removeMarkers(markers);
        markers = [];

        fuglemap.forEach(function (rd) {
          markers.push(
            new google.maps.Marker({
              position: rd.center,
              map: map,
              title: rd.sitename
            })
          )
        })
        
        markerCluster.addMarkers(markers)
      })
      document.getElementById("sinopac").addEventListener("click", function () {
        let sinopacmap = [];
        sinopac.forEach(function (rd) {
          sinopacmap.push(new Location(rd.county, rd.sitename, rd.address, rd.lat, rd.lng))
        });

        // 清空圖釘
        markerCluster.removeMarkers(markers);
        markers = [];

        sinopacmap.forEach(function (rd) {
          markers.push(
            new google.maps.Marker({
              position: rd.center,
              map: map,
              title: rd.sitename
            })
          )
        })
        
        markerCluster.addMarkers(markers)
      })
      document.getElementById("yuanto").addEventListener("click", function () {
        let yuantomap = [];
        yuanto.forEach(function (rd) {
          yuantomap.push(new Location(rd.county, rd.sitename, rd.address, rd.lat, rd.lng))
        });

        // 清空圖釘
        markerCluster.removeMarkers(markers);
        markers = [];

        yuantomap.forEach(function (rd) {
          markers.push(
            new google.maps.Marker({
              position: rd.center,
              map: map,
              title: rd.sitename
            })
          )
        })
        
        markerCluster.addMarkers(markers)
      })
      document.getElementById("taishin").addEventListener("click", function () {
        let taishinmap = [];
        taishin.forEach(function (rd) {
          taishinmap.push(new Location(rd.county, rd.sitename, rd.address, rd.lat, rd.lng))
        });

        // 清空圖釘
        markerCluster.removeMarkers(markers);
        markers = [];

        taishinmap.forEach(function (rd) {
          markers.push(
            new google.maps.Marker({
              position: rd.center,
              map: map,
              title: rd.sitename
            })
          )
        })
        
        markerCluster.addMarkers(markers)
      })

    }

    let map;

    function initMap() {

      let center = { lat: 23.97413508366366, lng: 120.97975310929014 };

      map = new google.maps.Map(document.getElementById("map"), {
        center: center,
        zoom: 6.5,
      });

    }

    window.initMap = initMap;

    function pinMarkerCluster(records) {
      records.forEach(function (rd) {
        markers.push(
          new google.maps.Marker({
            position: rd.center,
            map: map,
            title: rd.sitename
          })
        )
      })
      markerClusterer.MarkerClusterer({ map, markers });
      // new markerClusterer.MarkerClusterer({ markers, map });
    }

    // 將資料轉換為地圖可使用格式
    function Location(county, sitename, address, lat, lng) {
      this.county = county;
      this.sitename = sitename;
      this.address = address;
      this.lat = lat;
      this.lng = lng;

      this.title = county + sitename;
      this.center = { lat: parseFloat(lat), lng: parseFloat(lng) };
    }

    // function deleteMarkers(){
    //   new markerClusterer.clearMakers(true);
    // }
  </script>
  <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAyXOpDgS5QmETSDFK4jdpCRq3UGRSYB2g&callback=initMap&libraries=places&v=weekly"
    defer></script>
</body>

</html>